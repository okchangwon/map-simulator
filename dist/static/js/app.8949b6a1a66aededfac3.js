webpackJsonp([0],{"+5+h":function(t,e){},"/i6+":function(t,e,i){"use strict";var r={name:"MapLayer",props:{viewport:{type:Object}},data:function(){return{columnCount:41,rowCount:41,tileWidth:960,tileHeight:540,tileImagePath:"static/map/bravo/enchiladacoke",mapWidth:0,mapHeight:0,tiles:[]}},mounted:function(){var t=this;this.mapWidth=this.columnCount*this.tileWidth,this.mapHeight=this.rowCount*this.tileHeight,this.$nextTick(function(){t.createTiles()})},computed:{visibleTiles:function(){for(var t=[],e=Math.floor(this.viewport.left/this.tileWidth),i=Math.ceil(this.viewport.width/this.tileWidth)+1,r=Math.floor(this.viewport.top/this.tileHeight),n=Math.ceil(this.viewport.height/this.tileHeight)+1,o=r;o<r+n;o++)for(var s=e;s<e+i;s++)this.tiles[o]&&this.tiles[o][s]&&t.push(this.tiles[o][s]);return t}},methods:{isVisibleTile:function(t){return-1!==this.visibleTiles.indexOf(t)&&!t.disabled},createTiles:function(){for(var t=[],e=0;e<this.rowCount;e++)for(var i=0;i<this.columnCount;i++){t[e]||(t[e]={});var r=i,n=this.rowCount-e-1,o=r+"_"+n;t[e][i]={key:o,x:r,y:n,i:e,j:i,loaded:!1,disabled:!1}}this.tiles=t},getSourceURL:function(t,e){return this.tileImagePath+"/"+t+"_"+e+".jpeg"},onLoadImage:function(t){t.loaded=!0},onErrorLoadImage:function(t){t.disabled=!0}}},n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("table",{staticClass:"map-layer",style:{width:t.mapWidth+"px",height:t.mapHeight+"px"},on:{dragstart:function(t){t.preventDefault()}}},t._l(t.tiles,function(e){return i("tr",t._l(e,function(e){return i("td",{staticClass:"tile",style:{width:t.tileWidth+"px",height:t.tileHeight+"px"}},[t.isVisibleTile(e)?i("img",{key:e.key,style:{opacity:e.loaded?1:0},attrs:{src:t.getSourceURL(e.x,e.y)},on:{load:function(i){t.onLoadImage(e)},error:function(i){t.onErrorLoadImage(e)}}}):t._e()])}))}))},staticRenderFns:[]};var o=i("VU/8")(r,n,!1,function(t){i("+5+h")},"data-v-06d6408d",null);e.a=o.exports},"0/0x":function(t,e,i){"use strict";(function(t){var r=i("jCLi"),n=i("ldzV");e.a={name:"GridLayer",components:{AreaCell:r.a,DimmedCell:n.a},props:{viewport:{type:Object},visible:{type:Boolean}},data:function(){return{rowCount:40,columnCount:40,cellWidth:33,cellHeight:33,cells:[]}},computed:{tableWidth:function(){return 33*this.columnCount},tableHeight:function(){return 33*this.rowCount},adjustLeft:function(){return-32-this.viewport.left%152.814},adjustTop:function(){return 8-this.viewport.top%87.603}},mounted:function(){var e=this;this.$nextTick(function(){e.createCells(),e.setPositionByViewport(),e.updateCellXY(),setTimeout(function(){t(e.$el).css({opacity:1})},10)})},watch:{"viewport.left":function(){t(this.$el).css({left:this.viewport.left}),this.updateCellXY()},"viewport.top":function(){t(this.$el).css({top:this.viewport.top}),this.updateCellXY()}},methods:{setPositionByViewport:function(){t(this.$el).css({left:this.viewport.left,top:this.viewport.top})},updateCellXY:function(){for(var t=this.cells,e=0;e<this.rowCount;e++)for(var i=0;i<this.columnCount;i++){var r=e+1e3,n=i+1e3;r=r-Math.floor(this.viewport.left/152.814)+Math.floor(this.viewport.top/87.603),n=n+Math.floor(this.viewport.left/152.814)+Math.floor(this.viewport.top/87.603),t[e][i].x=r,t[e][i].y=n,t[e][i].i=e,t[e][i].j=i,t[e][i].key=r+"_"+n}},createCells:function(){for(var t=[],e=0;e<this.rowCount;e++)for(var i=0;i<this.columnCount;i++)t[e]||(t[e]={}),t[e][i]={x:0,y:0,i:e,j:i};this.cells=t},onClickCell:function(t){if(this.$store.state.area.selectedOwnerId){if(this.isDimmed(t))return;this.$store.commit("toggleArea",{x:t.x,y:t.y})}},isArea:function(t,e){return(e=e||this.$store.state.area.areas).find(function(e){return e.x===t.x&&e.y===t.y})},isDimmed:function(t){if(!this.$store.state.area.selectedOwnerId)return!1;var e=this.$store.state,i=e.area.areas.filter(function(t){return t.ownerId===e.area.selectedOwnerId}),r=e.area.areas.filter(function(t){return t.ownerId!==e.area.selectedOwnerId}),n=!0;return i.length&&!this.isArea(t,r)?this.isArea(t,i)?n=!1:this.cells[t.i][t.j-1]&&this.isArea(this.cells[t.i][t.j-1],i)?n=!1:this.cells[t.i][t.j+1]&&this.isArea(this.cells[t.i][t.j+1],i)?n=!1:this.cells[t.i-1]&&this.cells[t.i-1][t.j]&&this.isArea(this.cells[t.i-1][t.j],i)?n=!1:this.cells[t.i+1]&&this.cells[t.i+1][t.j]&&this.isArea(this.cells[t.i+1][t.j],i)&&(n=!1):this.isArea(t,r)||this.isArea(t,i)||(n=!1),n}}}}).call(e,i("7t+N"))},"0Vdb":function(t,e,i){"use strict";(function(t){var r=i("/i6+"),n=i("x01T");e.a={name:"MapArea",components:{MapLayer:r.a,GridLayer:n.a},data:function(){return{viewport:{left:0,top:0,width:0,height:0},isScrolling:!1,scrollingTimer:null,mousedownFlag:!1,mousedownOffset:null,isDragging:!1,showGridChecked:!0}},computed:{renderGrid:function(){return!this.isScrolling}},mounted:function(){var e=this;this.$nextTick(function(){e.setScroll(),e.viewport.width=t(e.$refs.stage).width(),e.viewport.height=t(e.$refs.stage).height(),e.viewport.mapWidth=e.$refs.mapLayer.$data.mapWidth,e.viewport.mapHeight=e.$refs.mapLayer.$data.mapHeight,t(window).on("resize",function(){e.viewport.width=t(e.$refs.stage).width(),e.viewport.height=t(e.$refs.stage).height()}),t(e.$refs.stage).on("mousedown",e.onMousedown.bind(e)),t(window).on("mousemove",e.onMousemove.bind(e)),t(window).on("mouseup",e.onMouseup.bind(e)),localStorage.getItem("viewportLeft")?(e.viewport.left=localStorage.getItem("viewportLeft"),e.viewport.top=localStorage.getItem("viewportTop")):e.setViewportToCenter()})},watch:{"viewport.left":function(e){t(this.$refs.stage).scrollLeft(e),localStorage.setItem("viewportLeft",e)},"viewport.top":function(e){t(this.$refs.stage).scrollTop(e),localStorage.setItem("viewportTop",e)}},methods:{setScroll:function(){t(this.$refs.stage).scrollLeft(this.viewport.left),t(this.$refs.stage).scrollTop(this.viewport.top)},setViewportToCenter:function(){this.viewport.left=this.$refs.mapLayer.$data.mapWidth/2,this.viewport.top=this.$refs.mapLayer.$data.mapHeight/2},onScroll:function(e){var i=t(e.target);return this.viewport.left=i.scrollLeft(),this.viewport.top=i.scrollTop(),this.setScrollingFlag(),e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation(),!1},setScrollingFlag:function(){var t=this;this.isScrolling=!0,this.scrollingTimer&&clearTimeout(this.scrollingTimer),this.scrollingTimer=setTimeout(function(){t.$nextTick(function(){t.isScrolling=!1})},50)},adjustViewportPosition:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,r=Math.max(0,this.viewport.left+t*i),n=Math.max(0,this.viewport.top+e*i);r=Math.min(r,this.$refs.mapLayer.$data.mapWidth-this.viewport.width),n=Math.min(n,this.$refs.mapLayer.$data.mapHeight-this.viewport.height),this.viewport.left=r,this.viewport.top=n},onMousewheel:function(t){this.adjustViewportPosition(t.deltaX,t.deltaY,3)},onMousedown:function(t){this.mousedownFlag=!0,this.mousedownOffset={x:t.offsetX,y:t.offsetY},this.isDragging=!1},onMousemove:function(t){this.mousedownFlag&&(this.isDragging?this.adjustViewportPosition(-t.originalEvent.movementX,-t.originalEvent.movementY,1):Math.abs(this.mousedownOffset.x-t.offsetX)+Math.abs(this.mousedownOffset.y-t.offsetY)>2&&(this.isDragging=!0))},onMouseup:function(t){this.mousedownFlag=!1,this.isDragging=!1}}}}).call(e,i("7t+N"))},"3NqY":function(t,e){},"6Kb0":function(t,e){},B245:function(t,e){},NHnr:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i("7+uW"),n={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"wrap"},[e("router-view")],1)},staticRenderFns:[]},o=i("VU/8")({name:"App"},n,!1,null,null,null).exports,s=i("/ocq"),a=i("0Vdb"),l={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"map-area",class:{dragging:t.isDragging}},[i("div",{ref:"stage",staticClass:"map-scroll-stage",on:{scroll:t.onScroll,mousewheel:function(e){e.preventDefault(),t.onMousewheel(e)}}},[i("map-layer",{ref:"mapLayer",attrs:{viewport:t.viewport}}),t._v(" "),t.renderGrid?i("grid-layer",{attrs:{viewport:t.viewport,visible:t.showGridChecked}}):t._e()],1),t._v(" "),i("div",{staticClass:"map-pos"},[t._v("\n    "+t._s(Math.floor(t.viewport.left))+","+t._s(Math.floor(t.viewport.top))),i("br"),t._v(" "),i("label",[i("input",{directives:[{name:"model",rawName:"v-model",value:t.showGridChecked,expression:"showGridChecked"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.showGridChecked)?t._i(t.showGridChecked,null)>-1:t.showGridChecked},on:{change:function(e){var i=t.showGridChecked,r=e.target,n=!!r.checked;if(Array.isArray(i)){var o=t._i(i,null);r.checked?o<0&&(t.showGridChecked=i.concat([null])):o>-1&&(t.showGridChecked=i.slice(0,o).concat(i.slice(o+1)))}else t.showGridChecked=n}}}),t._v(" Grid")])])])},staticRenderFns:[]};var c=function(t){i("xgHN")},u=i("VU/8")(a.a,l,!1,c,"data-v-dae058dc",null).exports,h={name:"AreaTool",computed:{owners:function(){return this.$store.state.area.owners},selectedOwnerId:function(){return this.$store.state.area.selectedOwnerId}},methods:{onClickOwner:function(t){this.$store.commit("toggleOwner",{ownerId:t.id})},onDblclick:function(t){var e=prompt("이름을 변경하세요.",t.name);e&&(t.name=e)},onClickAddOwner:function(){var t=Array(3).fill(null).map(function(t){return Math.floor(51+153*Math.random()).toString(16)});this.$store.commit("addOwner",{name:"user{seq}",color:"#"+t.join("")})},onClickRemoveOwner:function(t){this.$store.commit("removeOwner",{ownerId:t.id})}}},d={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"area-tool"},[i("h2",{staticClass:"tool-title"},[t._v("영역 설정")]),t._v(" "),i("ul",{staticClass:"tool-body"},[i("li",{staticClass:"add"},[i("button",{on:{click:t.onClickAddOwner}},[t._v("추가")])]),t._v(" "),t._l(t.owners,function(e){return i("li",{key:e.id,staticClass:"owner",class:{selected:t.selectedOwnerId===e.id},on:{click:function(i){t.onClickOwner(e)},dblclick:function(i){t.onDblclick(e)}}},[i("button",{style:{"background-color":e.color}},[t._v(t._s(e.name))]),t._v(" "),i("span",{staticClass:"remove-btn",on:{click:function(i){i.stopPropagation(),t.onClickRemoveOwner(e)},dblclick:function(t){t.stopPropagation()}}},[t._v("삭제")])])})],2)])},staticRenderFns:[]};var f={name:"ToolArea",components:{AreaTool:i("VU/8")(h,d,!1,function(t){i("hLLj")},"data-v-5ba82b80",null).exports}},p={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"tool-area"},[e("h1",[this._v("듀랑고 맵 시뮬레이터")]),this._v(" "),e("area-tool")],1)},staticRenderFns:[]};var m={name:"MapSimulator",components:{MapArea:u,ToolArea:i("VU/8")(f,p,!1,function(t){i("B245")},"data-v-06f1bbc2",null).exports},data:function(){return{}},mounted:function(){}},w={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"map-simulator"},[e("map-area"),this._v(" "),e("tool-area")],1)},staticRenderFns:[]};var v=i("VU/8")(m,w,!1,function(t){i("6Kb0")},"data-v-3ad0e5fe",null).exports,g={render:function(){var t=this.$createElement;return(this._self._c||t)("div",[this._v("404 Not Found")])},staticRenderFns:[]};i("VU/8")({},g,!1,null,null,null).exports;r.a.use(s.a);var C=new s.a({routes:[{path:"/",redirect:"/map-simulator"},{path:"/map-simulator",name:"map-simulator",component:v}]}),y=i("NYxO"),x={state:{owners:[{id:1,color:"#0000ff",name:"옥"},{id:2,color:"#00ff00",name:"박"}],areas:[],selectedOwnerId:null},mutations:{addOwner:function(t,e){var i=t.owners.length?Math.max.apply(null,t.owners.map(function(t){return t.id}))+1:1;t.owners.push({id:i,name:e.name.replace("{seq}",i)||i,color:e.color}),1===t.owners.length&&(t.selectedOwnerId=i)},removeOwner:function(t,e){var i=t.owners.find(function(t){return t.id===e.ownerId}),r=t.areas.filter(function(t){return t.ownerId===e.ownerId});t.owners.splice(t.owners.indexOf(i),1),r.forEach(function(e){t.areas.splice(t.areas.indexOf(e),1)})},toggleOwner:function(t,e){t.selectedOwnerId=t.selectedOwnerId===e.ownerId?null:e.ownerId},toggleArea:function(t,e){var i=t.areas.find(function(t){return t.x===e.x&&t.y===e.y});i&&t.areas.splice(t.areas.indexOf(i),1),i&&i.ownerId===t.selectedOwnerId||t.areas.push({ownerId:t.selectedOwnerId,x:e.x,y:e.y})}}};r.a.use(y.a);var _=new y.a.Store({modules:{area:x}});r.a.config.productionTip=!1,new r.a({el:"#app",store:_,router:C,components:{App:o},template:"<App/>"})},hLLj:function(t,e){},jCLi:function(t,e,i){"use strict";var r={name:"AreaCell",props:{x:{type:Number},y:{type:Number}},computed:{area:function(){var t=this;return this.$store.state.area.areas.find(function(e){return e.x===t.x&&e.y===t.y})},owner:function(){var t=this;return this.$store.state.area.owners.find(function(e){return e.id===t.area.ownerId})},backgroundColor:function(){return"rgba("+this.owner.color.replace(/[^0-9a-z]/gi,"").replace(/([0-9a-z]{2})/g,"|$1").split("|").slice(1).map(function(t){return parseInt(t,16)}).join(",")+", 0.5)"}}},n={render:function(){var t=this.$createElement,e=this._self._c||t;return this.area&&this.owner?e("span",{staticClass:"area-cell",style:{"background-color":this.backgroundColor}},[this._v(this._s(this.owner.name))]):this._e()},staticRenderFns:[]};var o=i("VU/8")(r,n,!1,function(t){i("pA8N")},null,null);e.a=o.exports},ldzV:function(t,e,i){"use strict";var r={render:function(){var t=this.$createElement;return(this._self._c||t)("span",{staticClass:"dimmed-cell"})},staticRenderFns:[]};var n=i("VU/8")({name:"DimmedCell"},r,!1,function(t){i("y8zU")},null,null);e.a=n.exports},pA8N:function(t,e){},x01T:function(t,e,i){"use strict";var r=i("0/0x"),n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"grid-layer"},[i("table",{ref:"table",class:{transparent:!t.visible},style:{width:t.tableWidth+"px",height:t.tableHeight+"px",left:t.adjustLeft+"px",top:t.adjustTop+"px"}},t._l(t.cells,function(e){return i("tr",t._l(e,function(e){return i("td",{key:e.key,staticClass:"cell",style:{width:t.cellWidth+"px",height:t.cellHeight+"px"},attrs:{title:e.x+", "+e.y},on:{click:function(i){t.onClickCell(e)}}},[t.isArea(e)?i("area-cell",{attrs:{x:e.x,y:e.y}}):t._e(),t._v(" "),t.isDimmed(e)?i("dimmed-cell"):t._e()],1)}))}))])},staticRenderFns:[]};var o=function(t){i("3NqY")},s=i("VU/8")(r.a,n,!1,o,"data-v-17e2ba26",null);e.a=s.exports},xgHN:function(t,e){},y8zU:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.8949b6a1a66aededfac3.js.map